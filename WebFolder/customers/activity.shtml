<!DOCTYPE html>
<html lang="en">

<head>

    <!--#4DSCRIPT/webRedirectIfNotAuthorized-->

    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/head.shtml-->

    <!--#4DSCRIPT/webSelectCustomerRecord-->


    <!-- PQGRID FUNCTION -->
    <script type="text/javascript">
        function loadGrid(element, wapi_filter) {

            console.trace();


            var theTable = element.id.replace("grid-data-", ""); //get the 4D table name

            if (theTable === undefined) {
                var theTable = '';
            };

            if (wapi_filter === undefined) {
                var wapi_filter = [{
                    dataIndx: 'customers___customerid',
                    value: '<!--#4DTEXT [Customers]customerid -->',
                    condition: 'equal'
                }]

                //customers___customerid: '<!--#4DTEXT [Customers]customerid -->'
            };


            <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_gettablename.js-->
            <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_datepicker.js-->  
            <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_viewRecord.js-->  
            <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_commentRender.js--> 

            //--------- INITIALIZATION FUNCTION -----------
            <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_initGrid.js-->


            //--------- DEFINE GRID OBJECT -----------
            //          NOTE: grid object var = obj
            var obj = {
                //create grid with defaults
                <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_createGrid.js-->  
                //set override - additional options
                height: "100%",
                showTitle: false,
                rowHt: 35,
                scrollModel: {
                    autoFit: false
                },
            };

            //----------- CREATE EVENT  -- USED FOR TOOL TIP WIDGET -------------            


            //----------- DATA READY EVENT (this sets the listbox title) --------------
            obj.dataReady = function() {
                <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_evtDataReady.js-->
            };

            // ----------SORT MODEL -----------
            obj.sortModel = {
                    type: 'remote',
                     //  sorter: [{
                      //     dataIndx: 'invoices___invoicedate',
                     //      dir: 'down'
                    // }],
                 };

            //---------- BEFORE SORT EVENT ------------     
            obj.beforeSort = function(evt) {
                if (evt.originalEvent) {  //only if sorting done through header cell click.
                    pqListbox.init();
                }
            };

            // ----------- BEFORE FILTER EVENT ------
            obj.beforeFilter = function(){
pqListbox.init();
            };

            //---------- BEFORE TABLE VIEW EVENT ------------           
            obj.beforeTableView = function(evt, ui) {
                var initV = ui.initV,
                    finalV = ui.finalV,
                    data = pqListbox.data,
                    rpp = pqListbox.rpp,
                    requestPage;

                if (initV != null) {
                    //if records to be displayed in viewport are not present in local cache,
                    //then fetch them from remote database/server.
                    if (data[initV] && data[initV].pq_empty) {
                        requestPage = Math.floor(initV / rpp) + 1;
                    }
                    else if (data[finalV] && data[finalV].pq_empty) {
                        requestPage = Math.floor(finalV / rpp) + 1;
                    }

                    if (requestPage >= 1) {
                        if (pqListbox.requestPage != requestPage) {     
                            pqListbox.requestPage = requestPage;
                            //initiate remote request.                    
                            this.refreshDataAndView();
                        }
                    }
                };
   
            };


            //--------------CREATE TOOLBAR  ------------- 


            //--------------- DEFINE COLUMN MODEL -------------------
            // ADD COLUMNS TO THE GRID HERE -- USE 4D TABLENAME___FIELDNAME 
            // THE FIRST COLUMN SHOULD BE THE PK/ID FIELD FOR THE TABLE - YOU CAN SET HIDDEN:TRUE
            // https://paramquery.com/pro/api#option-colModel <-- doc's and options


            switch (theTable) {

                case 'invoices':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___invoiceid, filter:false, hidden:false, width:100} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___customerfullname, title:Customer, filter:true, hidden:true, width:150} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___invoiceserial, title:Serial, filter:false, hidden:true, width:80} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___invoicedate, title:Date ,filter:false, align:center, Width:80} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___amlbeneficiaryname, title:Beneficiary, filter:true, width:150} -->,

                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___fromamount, title:From-Amt, format:currency, filter:false, width:80} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{function:webgetflag_InvoicesFrom, title:Flag, filter:false, maxWidth:70} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___fromcurrency, title:CCY, filter:false, maxWidth:50} -->,

                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___toamount, title:To-Amt, format:currency, filter:false, width:80} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{function:webgetflag_InvoicesTo, title:Flag, filter:false, maxWidth:70} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___tocurrency, title:CCY, filter:false, maxWidth:50} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___sourceoffund, title:Source, filter:true, width:150} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___amlpurposeoftransaction, title:Purpose, filter:true, width:150} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:invoices___printRemarks, title:Notes, filter:true, hidden:false, width:300} -->,
                    ];



                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.invoices___invoiceid;
                        var thePrimaryKey = 'invoices___invoiceid';
                        var theForm = 'modal-form';
                        var theViewPage = 'customers/invoices-form-accordian.shtml';
                        var thePrintPage = '';
                        var theEditPage = ''; //'wapi/update.shtml';
                        var theTable = 'invoices';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'wires':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___cxr_wireid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___wiretransferdate, title:Date ,filter:false, align:center, maxWidth:80} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___cxr_wireid, title:ID, filter:false, maxWidth:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___cxr_accountid, title:Acct-Name, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___cxr_subaccountid, title:Sub-Acct, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___cxr_invoiceid, title:Inv-ID, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___wireno, title:Wire-No, filter:false, maxWidth:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___isoutgoingwire, title:Sent, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___amount, title:Amount, format:currency, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wires___currency, title:CCY, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'wires___wiretransferdate',
                            dir: 'down'
                        }],
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.wires___cxr_wireid;
                        var thePrimaryKey = 'wires___cxr_wireid';
                        var theForm = 'modal-form';
                        var theViewPage = 'customers/wires-dialog.shtml';
                        var thePrintPage = '';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'wires';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'ewires':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___ewireid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___senddate, title:Date ,filter:false, align:center, width:100} -->,   		
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___issettled, title:Settled, filter:false, width:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___beneficiaryFullName,title:Beneficiary, filter:false, width:150} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___fromCountry,title:From, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___toCountry,title:To, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___currency,title:CCY, filter:false, width:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___fromAmount,title:From-Amt, format:currency , filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:ewires___toAmount,title:To-Amt, format:currency, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'ewires___senddate',
                            dir: 'down'
                        }],
                    };

                    obj.rowInit = function(ui) {

                        switch (ui.rowData.ewires___issettled) {

                            case true:
                                return {
                                    style: "background:gray; font-style:italic;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case false:
                                return {
                                    style: "background:orange;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };

                                break;
                        }
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.ewires___ewireid;
                        var thePrimaryKey = 'ewires___ewireid';
                        var theForm = 'modal-form';
                        var theViewPage = 'customers/ewires-dialog.shtml';
                        var thePrintPage = '';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'ewires';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'webewires':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___webewireid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___linkid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___status, title:Status, filter:false, hidden:true} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___webewireid, filter:false, hidden:false, width:100} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{function:webGetWebewireMgReferenceNum, title:MG-Ref-Num, filter:false, hidden:false, width:110} -->,
                        
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___creationdate, title:Date ,filter:false, align:center, width:80} -->,   		

                        <!--#4DSCRIPT/WAPI_ColModel/{field:webewires___status, title:Status, filter:false, width:120} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{function:webGetWebewireStatusText, title:Status, filter:false, hidden:false, width:120} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___toparty___fullName,title:Beneficiary, filter:false, width:150} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___fromCCY,title:From CCY, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___toCCY,title:To CCY, filter:false} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___directrate,title:Rate, filter:false, maxWidth:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___fromamount,title:From-Amt, format:currency , filter:false, width:80} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___toamount,title:To-Amt, format:currency, filter:false, width:80} -->,

                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:webewires___notes,title:Notes, filter:false, width:300} -->,
                    ];

                    obj.colModel[5].render = function(ui) {
                        var rowData = ui.rowData,
                            dataIndx = ui.dataIndx;

                        switch (rowData[dataIndx]) {

                            case -20:
                                return 'Denied';
                                break;

                            case -10:
                                return 'Cancelled';
                                break;

                            case 0:
                                return 'Draft';
                                break;

                            case 5:
                                return 'Waiting on Payment';
                                break;

                            case 10:
                                return 'Pending Review';
                                break;

                            case 20:
                                return 'Approved';
                                break;

                            case 30:
                                return 'Sent';
                                break;

                            case 40:
                                return 'Complete';
                                break;
                        }
                    };

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'webewires___creationdate',
                            dir: 'down'
                        }],
                    };

                    obj.rowInit = function(ui) {

                        switch (ui.rowData.webewires___status) {

                            case -20: //denied
                                return {
                                    style: "color:gray; font-style:italic;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case -10: //cancelled
                                return {
                                    style: "color:gray; font-style:italic;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case 0: //draft
                                return {
                                    style: "background:#ffffe6;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case 5: //pending payment
                                return {
                                    style: "background:#e6f2ff;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case 10: //pending review
                                return {
                                    style: "background:#e6f2ff;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };
                                break;

                            case 20: //approved
                                return {
                                    style: "background:#f2ffe6;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };

                                break;

                            case 30: //sent
                                return {
                                    style: "background:#f2ffe6;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };

                                break;

                            case 40: //completed
                                return {
                                    style: "background:#f2ffe6;" //can also return attr (for attributes) and cls (for css classes) properties.
                                };

                                break;
                        }
                    };

                    obj.rowSelect = function(evt, ui) {

                        var row = ui.addList[0];
                        var id = row.rowData.webewires___webewireid;
                        var linkid = row.rowData.webewires___linkid;
                        var name = row.rowData.webewires___toparty___fullName;
                        var amt = row.rowData.webewires___toamount;
                        var toCCY = row.rowData.webewires___toCCY;
                        var date = row.rowData.webewires___creationdate;
                        var custid = '<!--#4DTEXT [Customers]customerid -->';
                        var status = row.rowData.webewires___status;

                        if (status === -10 || status >= 20 || status === -20) {
                            $("#webewires-cancel-button").val('No Cancel Available:  ' + name);
                            $("#webewires-cancel-button").attr('disabled', true);
                            $("#webewires-cancel-button").removeAttr('data-wapi-record');
                            $("#webewires-cancel-button").removeAttr('data-wapi-table');

                        } else {
                            $("#webewires-cancel-button").val('Cancel ' + wapiAddCommas(amt.toFixed(2)) + " " + toCCY + ' to ' + name);
                            $("#webewires-cancel-button").removeAttr('disabled');
                            $("#webewires-cancel-button").attr('data-wapi-record', id);
                            $("#webewires-cancel-button").attr('data-wapi-table', 'webewires');

                            $("[id=webewires-webewireid-input]").val(id);
                            $("[id=webewires-customerid-input]").val(custid);
                            $("[id=webewires-linkid-input]").val(linkid);
                        }
                    };

                    obj.rowDblClick = function(evt, ui) {
debugger;
                        var id = ui.rowData.webewires___webewireid;
                        var thePrimaryKey = 'webewires___webewireid';
                        var theForm = 'modal-form';
                        var theViewPage = 'customers/webewires-view-content.shtml';
                        var thePrintPage = '';
                        var theEditPage = '';
                        var theTable = 'webewires';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'bookings':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___bookingid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___iscancelled, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___bookingdate, title:Date ,filter:false, align:center, Width:100} -->, 
                        <!--#4DSCRIPT/WAPI_ColModel/{function:webgetflag_bookings, title:Flag, filter:false, width:70} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___currency, title:CCY, filter:false, width:70} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___amount,title:Amount, filter:false, format:currency, width:120} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___ourrate,title:Rate, filter:false, width:120} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___amountlocal,title:Local-Amt, filter:false, format:currency, width:120} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___issell,title:Is-Buy, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___isconfirmed,title:Confirmed, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___ishonored,title:Honored, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:bookings___expirydate, filter:false, hidden:false, width:80} -->,
                    ];

                    obj.colModel[7].render = function(ui) {
                        var rowData = ui.rowData,
                            dataIndx = ui.dataIndx;

                        switch (rowData[dataIndx]) {

                            case true:
                                return 'Sell';
                                break;

                            case false:
                                return 'Buy';
                                break;
                        }
                    };

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'bookings___bookingdate',
                            dir: 'down'
                        }],
                    };

                    obj.rowInit = function(ui) {

                        if (ui.rowData.bookings___iscancelled === true) {
                            return {
                                style: "color:gray;font-style:italic;"
                            };
                        };

                        if (ui.rowData.bookings___ishonored === true) {
                            return {
                                style: "background-color:palegreen;"
                            };
                        } else if (ui.rowData.bookings___isconfirmed === true) {
                            return {
                                style: "background-color:paleturquoise;"
                            };
                        }

                    };

                    obj.rowSelect = function(evt, ui) {

                        var row = ui.addList[0];
                        var id = row.rowData.bookings___bookingid;
                        var amt = row.rowData.bookings___amount;
                        var date = row.rowData.bookings___bookingdate;
                        var custid = '<!--#4DTEXT [Customers]customerid -->';
                        var isconfirmed = row.rowData.bookings___isconfirmed;
                        var ishonored = row.rowData.bookings___ishonored;
                        var iscancelled = row.rowData.bookings___iscancelled;


                        if (isconfirmed === true || ishonored === true || iscancelled === true) {
                            $("#bookings-cancel-button").val('No Cancel Available');
                            $("#bookings-cancel-button").attr('disabled', true);
                            $("#bookings-cancel-button").removeAttr('data-wapi-record');
                            $("#bookings-cancel-button").removeAttr('data-wapi-table');
                        } else {
                            $("#bookings-cancel-button").val('Cancel the ' + date + ' Booking for  ' + amt);
                            $("#bookings-cancel-button").removeAttr('disabled');
                            $("#bookings-cancel-button").attr('data-wapi-record', id);
                            $("#bookings-cancel-button").attr('data-wapi-table', 'bookings');

                            $("[id=bookings-bookingid-input]").val(id);
                            $("[id=bookings-customerid-input]").val(custid);
                        }
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.bookings___bookingid;
                        var thePrimaryKey = 'bookings___bookingid';
                        var theForm = 'booking-form';
                        var theViewPage = 'customers/bookings-dialog.shtml';
                        var thePrintPage = '/customers/bookings-print.shtml';
                        var theEditPage = '';
                        var theTable = 'bookings';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'links':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___linkid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___fullname, title:Name ,filter:false, width:120} -->,   			
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___relationship, title:Relship, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___city,title:City, filter:false, maxWidth:100} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___country,title:Country, filter:false, maxWidth:100} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___mainphone,title:Main-Phone, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:links___email,title:Email, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'links___fullname',
                            dir: 'up'
                        }],
                    };

                    obj.rowSelect = function(evt, ui) {

                        var row = ui.addList[0];
                        var id = row.rowData.links___linkid; //this is the beneficiary
                        var name = row.rowData.links___fullname;
                        var custid = '<!--#4DTEXT [Customers]customerid -->' //row.rowData.links___customerid;

                        // $("#links-send-ewire-button").val('Send eWire to  ' + name);
                        //$("#links-send-ewire-button").removeAttr('disabled');
                        //$("[id=ewires-linkid-input]").val(id);
                        //$("[id=ewires-customerid-input]").val(custid);

                        $("#links-send-webewire-button").val('Request eWire to  ' + name);
                        $("#links-send-webewire-button").removeAttr('disabled');
                        $("[id=webewires-linkid-input]").val(id);
                        $("[id=webewires-customerid-input]").val(custid);

                        $("#links-update-button").val('Update  ' + name);
                        $("#links-update-button").removeAttr('disabled');
                        $("[id=links-linkid-input]").val(id);
                        $("[id=links-customerid-input]").val(custid);
                        //alert(str)
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var name = ui.rowData.links___fullname;
                        var id = ui.rowData.links___linkid;
                        var thePrimaryKey = 'links___linkid';
                        var theForm = 'modal-form';
                        var theViewPage = 'customers/links-form.shtml';
                        var thePrintPage = '/customers/links-print.shtml';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'links';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'wiretemplates':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___wiretemplateid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___wiretemplateid, filter:false, title:ID} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___wiretemplatealias, title:Name ,filter:false} -->,   			
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___bankname, title:Bank, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___beneficiaryfullname,title:Beneficiary, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:wiretemplates___remarks,title:Remarks, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'wiretemplates___wiretemplatealias',
                            dir: 'up'
                        }],
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.wiretemplates___wiretemplateid;
                        var thePrimaryKey = 'wiretemplates___wiretemplateid';
                        var theForm = 'modal-form';
                        var theViewPage = 'wapi/view.shtml';
                        var thePrintPage = '';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'wiretemplates';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


                case 'linkeddocs':
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___linkeddocid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___docreference, title:Ref ,filter:false, align:center, maxWidth:80} -->,   		
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___typeofdoc, title:Type, filter:false, maxWidth:50} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___issuecountry,title:Issued, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___scannedimage,title:Image, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_getColModelColumn/{field:linkeddocs___description,title:Description, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'linkeddocs___docreference',
                            dir: 'up'
                        }],
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.linkeddocs___linkeddocid;
                        var thePrimaryKey = 'linkeddocs___linkeddocid';
                        var theForm = 'linkeddocs-form';
                        var theViewPage = 'wapi/view.shtml';
                        var thePrintPage = '';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'linkeddocs';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;

                case 'webattachments': //<>TODO
                    obj.colModel = [
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___uuid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___relatedid, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___relatedtablenum, filter:false, hidden:true} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___createdate, title:Date ,filter:false, align:center, maxWidth:100} -->,   		
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___cxrtype, title:Type, filter:false, width:100} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___description,title:Description, filter:false} -->,
                        <!--#4DSCRIPT/WAPI_ColModel/{field:webattachments___preview,title:Image, filter:false} -->,
                    ];

                    obj.sortModel = {
                        sorter: [{
                            dataIndx: 'webattachments___createdate',
                            dir: 'down'
                        }],
                    };

                    obj.rowDblClick = function(evt, ui) {

                        var id = ui.rowData.webattachments___uuid;
                        var thePrimaryKey = 'webattachments___uuid';
                        var theForm = 'webattachments-form';
                        var theViewPage = 'customers/webattachments-dialog.shtml';
                        var thePrintPage = 'wapi/print.shtml';
                        var theEditPage = 'wapi/update.shtml';
                        var theTable = 'webattachments';
                        var viewForm = new FormData();

                        viewForm.append(thePrimaryKey, id);
                        viewForm.append('table', theTable);
                        viewForm.append('primarykey', thePrimaryKey);
                        viewForm.append('action', 'view');
                        viewForm.append('readonly', 'true');
                        viewForm.append('request', theViewPage);

                        var request = new XMLHttpRequest();

                        request.onreadystatechange = wapiDisplayModalDialog(request, {
                            'form': theForm,
                            'view': theViewPage,
                            'print': thePrintPage,
                            'update': theEditPage,
                            'table': theTable,
                            'id': id,
                            'primarykey': thePrimaryKey
                        }); //theForm, thePrintPage);
                        request.responseType = 'text';
                        request.open('POST', 'readRecord');
                        request.send(viewForm);
                        request.response;

                    };

                    break;


            };




            // ------------- DEFINE DATAMODEL -----------
            obj.dataModel = {
                <!--#4DSCRIPT/WAPI_4DInclude/app/pq/include/pq_dataModel.js--> 
             };



            // ------------- DEFINE FILTERMODEL -----------      
            obj.filterModel = {
                header: false,
                //on: true,
                type: 'remote',
                menuIcon: true,
            }

            //--------------DEFINE GROUP MODEL -------------
            // NONE



            //---------- INSERT THE GRID INTO THE DOM ---------------
            var theGrid = pq.grid("div#grid-" + theTable, obj);

        };

    </script>


    <!-- ON READY -- ADD ON SHOW ACCORDIAN EVENT HERE -->
    <script type="text/javascript">
        $(function() {

            // ADD ON SHOW ACCORDIAN EVENT HERE -----  

            var customerID = '<!--#4DSCRIPT/WAPI_getSession/customerid-->' //'<!--#4DTEXT [Customers]customerid -->';

            $('#grid-data-invoices').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'invoices___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-invoices").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    pq.grid('#grid-invoices').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });

            $('#grid-data-wires').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'wires___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-wires").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    //$('#grid-wires').pqGrid("refreshDataAndView");
                    pq.grid('#grid-wires').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });

            $('#grid-data-ewires').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'ewires___customerid',
                    value: customerID,
                    condition: 'equal'
                }];


                if ($("#grid-ewires").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    //$('#grid-ewires').pqGrid("refreshDataAndView");
                    pq.grid('#grid-ewires').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });

            $('#grid-data-webewires').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'webewires___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-webewires").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    pq.grid('#grid-webewires').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });


            $('#grid-data-links').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'links___customerid',
                    value: customerID,
                    condition: 'equal'
                }];


                if ($("#grid-links").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    // $('#grid-links').pqGrid("refreshDataAndView");
                    pq.grid('#grid-links').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });

            $('#grid-data-bookings').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'bookings___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-bookings").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    //$('#grid-bookings').pqGrid("refreshDataAndView");
                    pq.grid('#grid-bookings').refreshDataAndView();
                };
                wapiSetSession('homeSelectedDiv', this.id);
            });


            $('#grid-data-wiretemplates').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'wiretemplates___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-wiretemplates").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    //$('#grid-wiretemplates').pqGrid("refreshDataAndView");
                    pq.grid('#grid-wiretemplates').refreshDataAndView();
                };

                wapiSetSession('homeSelectedDiv', this.id);
            });

            $('#grid-data-linkeddocs').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'linkeddocs___customerid',
                    value: customerID,
                    condition: 'equal'
                }];

                if ($("#grid-linkeddocs").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    // $('#grid-linkeddocs').pqGrid("refreshDataAndView");
                    pq.grid('#grid-linkeddocs').refreshDataAndView();
                };

                wapiSetSession('homeSelectedDiv', this.id);

            });

            $('#grid-data-webattachments').on('show.bs.collapse', function() {
                var wapi_filter = [{
                    dataIndx: 'webattachments___relatedid',
                    value: customerID,
                    condition: 'equal'
                }, {
                    dataIndx: 'webattachments___relatedtablenum',
                    value: '3',
                    condition: 'equal'
                }];


                if ($("#grid-webattachments").hasClass("pq-grid") == false) {
                    loadGrid(this, wapi_filter);
                } else {
                    //$('#grid-webattachments').pqGrid("refreshDataAndView");
                    pq.grid('#grid-webattachments').refreshDataAndView();
                };

                wapiSetSession('homeSelectedDiv', this.id);

                //filter the data in grid. (Note the data parameter is not passed)

                /*                
                                var grid = $('#grid-webattachments').pqGrid('instance');

                                grid.filter({
                                    oper: 'replace',
                                    mode: 'AND',
                                    rules: [{
                                            dataIndx: 'webattachments___relatedid',
                                            condition: 'equal',
                                            value: customerID
                                        },
                                        {
                                            dataIndx: 'webattachments___relatedtablenum',
                                            condition: 'equal',
                                            value: '3'
                                        }
                                    ]
                                });*/
            });


            //open an accordian - maybe use user session setting
            var theDiv = '<!--#4DSCRIPT/WAPI_getSession/homeSelectedDiv-->';

            if (theDiv === undefined) {
                var theDiv = '';
            };

            if (theDiv !== '') {
                $('#' + theDiv).collapse('show');
                $('#' + theDiv).addClass('in');
                $('#' + theDiv).prop('aria-expanded', true); //aria-expanded='true'

            };


        })

    </script>

    <!--#4DSCRIPT/WAPI_pageStart/{sessiontimer:true}-->
</head>


<body>

    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/menubar.shtml-->

    <main role="main">

        <div class="page-header">

            <div class='container'>
                <h1>History and Activity</h1>
            </div>
        </div>


        <div class='container'>

            <!--#4DHTML WAPI_includeAlertMessage-->

            <!-- ACCOUNT AND TRANSACTION PANELS -->

            <div class='row'>

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
                    <!-- RELATED CUSTOMER TABLES -->

                    <div class="panel-group" id="accordion-related" role="tablist" aria-multiselectable='true'>

                        <!-- INVOICES -->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.invoices.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-invoices">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-invoices" aria-expanded="false" aria-controls="grid-data-invoices">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Transaction History</a>
                                </h3>
                            </div>

                            <div id="grid-data-invoices" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-invoices">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-invoices"></div><!-- INSERT INVOICES GRID HERE -->
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->


                        <!--WIRES-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.wires.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-wires">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-wires" aria-expanded="false" aria-controls="grid-data-wires">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Wires</a>
                                </h3>
                            </div>

                            <div id="grid-data-wires" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-wires">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-wires"></div><!-- INSERT WIRES GRID HERE -->
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->


                        <!--EWIRES-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.ewires.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-ewires">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-ewires" aria-expanded="false" aria-controls="grid-data-ewires">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> eWires</a>
                                </h3>
                            </div>

                            <div id="grid-data-ewires" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-ewires">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-ewires"></div><!-- INSERT WIRES GRID HERE -->
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->


                        <!--WEBEWIRES-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.webewires.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-webewires">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-webewires" aria-expanded="false" aria-controls="grid-data-webewires">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Money Transfer Requests</a>
                                </h3>
                            </div>

                            <div id="grid-data-webewires" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-webewires">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-webewires"></div><!-- INSERT WIRES GRID HERE -->
                                    </div>


                                    <div class="btn-group btn-group-justified" role="group" aria-label="webewires-toolbar">
                                        <div class="pull-right">
                                            <input id="webewires-cancel-button" class="btn btn-primary" type="submit" data-wapi-record='' data-wapi-table="" onclick="wapiConfirmExecuteMethod('webCancelWebEwire')" value="Cancel" style="display:block;" disabled>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->

                        <!--BOOKINGS-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.bookings.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-bookings">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-bookings" aria-expanded="false" aria-controls="grid-data-bookings">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Bookings</a>
                                </h3>
                            </div>

                            <div id="grid-data-bookings" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-bookings">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-bookings"></div><!-- INSERT WIRES GRID HERE -->
                                    </div>

                                    <div class="btn-group btn-group-justified" role="group" aria-label="bookings-toolbar">

                                        <div class="pull-right">

                                            <div class="btn-group" role="group" style="padding-right: 5px">
                                                <input id="bookings-cancel-button" class="btn btn-primary" type="submit" data-wapi-record='' data-wapi-table="" onclick="wapiExecuteMethod('webCancelBooking')" value="Cancel" style="display:block;" disabled>

                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->

                        <!--LINKED DOCS-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.linkeddocs.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-linkeddocs">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-linkeddocs" aria-expanded="false" aria-controls="grid-data-linkeddocs">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Supporting Documents and Picture IDs</a>
                                </h3>
                            </div>

                            <div id="grid-data-linkeddocs" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-linkeddocs">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-linkeddocs"></div><!-- INSERT LINKED DOCS GRID HERE -->
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->

                        <!--WEB ATTACHMENT-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.webattachments.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-webattachments">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-webattachments" aria-expanded="false" aria-controls="grid-data-webattachments">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Uploaded Documents</a>
                                </h3>
                            </div>

                            <div id="grid-data-webattachments" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-webattachments">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-webattachments"></div><!-- INSERT WEB ATTACHMENTS GRID HERE -->
                                    </div>

                                    <div class="btn-group btn-group-justified" role="group" aria-label="webattachments-toolbar">

                                        <div class="pull-right">

                                            <div class="btn-group" role="group" style="padding-right: 5px">
                                                <form enctype="multipart/form-data" id='webattachments-create-form' action="postPage" method="post">
                                                    <!--#4DSCRIPT/WAPI_formHeader/{table:webattachments, action:create, post:customers/webattachments-create.shtml}-->
                                                    <input type="hidden" id="webattachments-relatedid-input" name="webattachments-related-input" value="">
                                                    <input type="hidden" id="webattachments-relatedtablenum-input" name="webattachments-relatedtablenum-input" value="3">
                                                    <input type="submit" class="btn btn-primary" id="webattachments-create-button" name="webattachments-create-button" form="webattachments-create-form" value="New Document">
                                                </form>
                                            </div>
                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->

                        <!--#4DIF false-->
                        <!--LINKS-->
                        <!--#4DIF (webgetkeyvalue("web.customers.module.links.show")="false")-->
                        <!--#4DELSE-->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="grid-tab-links">
                                <h3 class="panel-title">
                                    <a class="collapsed" role="button" data-toggle="collapse" data-parent="#accordion-related" href="#grid-data-links" aria-expanded="false" aria-controls="grid-data-links">
                                        <span class="glyphicon glyphicon-menu-hamburger" aria-hidden="true"> </span> Beneficiaries</a>
                                </h3>
                            </div>

                            <div id="grid-data-links" class="panel-collapse collapse" role="tabpanel" aria-labelledby="grid-tab-links">

                                <div class="panel-body">

                                    <div class='form-group' style='height: 300px'>
                                        <div id="grid-links"></div><!-- INSERT WIRES GRID HERE -->
                                    </div>

                                    <div class="btn-group btn-group-justified" role="group" aria-label="links-toolbar">

                                        <div class="pull-right">

                                            <div class="btn-group" role="group" style="padding-right: 15px">
                                                <input type="submit" class="btn btn-primary btn-block" id="wapi-create-btn" name="wapi-create-btn" value="Add Beneficiary" onclick="wapiCreateForm({'request':'customers/links-create.shtml', 'table':'links', 'action':'create', 'primarykey':'links___linkid'})">
                                            </div>

                                            <div class="btn-group" role="group" style="padding-right: 5px">
                                                <form enctype="multipart/form-data" id='links-update-form' action="readRecord" method="post">
                                                    <!--#4DSCRIPT/WAPI_formHeader/{table:links, action:update, primarykey:links___linkid, request:customers/links-update.shtml}-->
                                                    <input type="hidden" id="links-linkid-input" name="links-linkid-input" value="">
                                                    <input type="hidden" id="links-customerid-input" name="links-customerid-input" value="">

                                                    <input type="submit" class="btn btn-primary" id="links-update-button" name="links-udpate-button" form="links-update-form" disabled value="Update Beneficiary">
                                                </form>
                                            </div>



                                        </div>
                                    </div>

                                </div>
                            </div>
                        </div>
                        <!--#4DENDIF-->
                        <!--#4DENDIF-->

                    </div>
                </div>

            </div>





        </div>
    </main>


    <!--FOOTER-->
    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/footer.shtml-->

    <!--#4DSCRIPT/webUpdateRequestStatus-->
</body>


</html>
