<!DOCTYPE html>
<html lang="en">

<head>

    <!--#4DSCRIPT/webRedirectIfNotAuthorized-->

    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/head.shtml -->

    <!--#4DSCRIPT/webSelectCustomerRecord-->

    <!--#4DSCRIPT/WAPI_pageStart/{onload:true, sessiontimer:true, dz-div:profile-id-form, dz-post:true, dz-maxfilesize:10, dz-maxfiles:4, dz-onaddedfile:addDropZone, dz-addremovelinks:false}-->

</head>


<body>

    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/menubar.shtml -->

    <main role="main">


        <!-- ACCOUNT AND TRANSACTION PANELS -->
        <div class="container" style="padding-bottom: 40px; padding-top: 0px">

            <div class="row">

                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">


                    <div class='panel panel-default'>

                        <div class='panel-heading'>
                            <div>
                                <span class="glyphicon glyphicon-user" aria-hidden="true"></span>

                                <!--#4DTEXT " "+[customers]firstname + " "+[customers]lastname-->
                                <!--#4DIF [customers]iscompany-->
                                <!--#4DTEXT " - "+[customers]companyname-->
                                <!--#4DENDIF-->&nbsp;

                                [
                                <!--#4DSCRIPT/wapi_getsession/username-->]

                                <span class="pull-right">
                                    <!-- add country flag -->
                                    <!--#4DTEXT webGetFlag_Customers-->
                                </span>
                            </div>


                        </div>

                        <div class='row'>
                            <div class='col-lg-3 col-md-3 colsm-6 col-xs-6'>
                                <div class='panel-body'>
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___address}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___city, field2:customers___province, field3:customers___postalcode}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___country_obs}-->
                                </div>
                            </div>
                            <div class='col-lg-3 col-md-3 colsm-6 col-xs-6'>
                                <div class='panel-body'>
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___customerid, label:ID}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___worktel, label:W}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___cellphone, label:M}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___email, label:Email}-->
                                </div>
                            </div>

                            <div class='col-lg-3 col-md-3 colsm-6 col-xs-6'>
                                <div class='panel-body'>
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___pictureid_type, label:ID-Type}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___pictureid_number, label:ID-Num}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___pictureid_issuedate, label:Issued}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___documentsVerificationDate, label:Verified}-->
                                    <!--#4DSCRIPT/WAPI_textGroup/{field:customers___documentsVerifiedBy, label:Verified-By}-->
                                </div>
                            </div>

                            <div class='col-lg-3 col-md-3 colsm-6 col-xs-6'>
                                <div class='panel-body'>
                                    <!--#4DTEXT webGetPictureCustomer -->
                                </div>
                            </div>

                        </div>

                    </div>


                    <div class="panel-group" id="accordion" role="tablist" aria-multiselectable='true'>

                        <!-- CONTACT INFORMATION -->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="profile-demographics-tab">
                                <h3 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                        href="#profile-demographics-data" aria-expanded="false"
                                        aria-controls="profile-demographics-data">
                                        <span class="glyphicon glyphicon-home" aria-hidden="true"></span>&nbsp; Edit
                                        Your Contact Info
                                        <span class="glyphicon glyphicon-pencil pull-right"></span></a>
                                </h3>
                            </div>

                            <div id="profile-demographics-data" class="panel-collapse collapse" role="tabpanel"
                                aria-labelledby="profile-demographics-tab">

                                <form enctype="multipart/form-data" id='profile-demographics-form'
                                    action="/updateRecord" method="post">

                                    <div>
                                        <!--#4DSCRIPT/WAPI_formHeader/{table:customers, primarykey:customers___customerid, success:customers/home.shtml}-->
                                    </div>


                                    <div class="panel-body">

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___firstname, label:First-Name, readonly:true, pattern:alpha}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___lastname, label:Last-Name, readonly:true, pattern:alpha}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___email, label:Email-Address, locked:true, readonly:true}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___gender, choicelist:webGetChoiceListGender, readonly:false}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___occupation, width:100px, readonly:false}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___address, readonly:false}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___city, width:100px, readonly:false, pattern:alpha}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___province, readonly:false, pattern:alpha}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___dob, label:Date-of-birth, readonly:true, inputmask-selectyears:80, inputmask-startyear:1970, inputmask-min:true}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___hometel, label:Phone, readonly:false, pattern:phone}-->
                                        </div>

                                        <div class="form-group">
                                            <!--#4DSCRIPT/WAPI_formGroup/{field:customers___cellphone, label:Mobile, readonly:false, pattern:phone}-->
                                        </div>


                                        <div class="btn-group pull-right" role="group" aria-label="profile-edit">
                                            <!--#4DIF false-->
                                            <a id="cancel-button-demographics" class="btn btn-default" role="button"
                                                style='display:none;' onclick="wapiObjectMethod(event)">Cancel</a>

                                            <a id="edit-button-demographics" class="btn btn-primary" role="button"
                                                style='display:none;' onclick="wapiObjectMethod(event)">Edit</a>
                                            <!--#4DENDIF-->

                                            <a class="btn btn-default" href="/customers/home.shtml"
                                                role="button">Cancel</a>

                                            <input id="save-button-demographics" class="btn btn-primary" type="submit"
                                                value="Save" formprofile-demographics-form style='display:block;'>
                                        </div>


                                    </div>
                                </form>
                            </div>
                        </div>


                        <!-- ID INFO AND PICTURE -->
                        <div class="panel panel-default">
                            <div class="panel-heading" role="tab" id="profile-id-tab">
                                <h3 class="panel-title">
                                    <a role="button" data-toggle="collapse" data-parent="#accordion"
                                        href="#profile-id-data" aria-expanded="false" aria-controls="profile-id-data">
                                        <span class="glyphicon glyphicon-camera" aria-hidden="true"></span>&nbsp;Your ID
                                        Documentation</a>
                                </h3>
                            </div>

                            <div id="profile-id-data" class="panel-collapse collapse" role="tabpanel"
                                aria-labelledby="profile-id-tab">

                                <form enctype="multipart/form-data" id='profile-id-form' action="/updateRecord"
                                    method="post">

                                    <div>
                                        <!--#4DSCRIPT/WAPI_formHeader/{table:customers, primarykey:customers___customerid, success:customers/home.shtml}-->
                                    </div>

                                    <div class="panel-body">
                                        
                                            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">

                                                <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_image, label:ID, readonly:true, image-width:310, image-height:0, image-compression:.5, image-upload:false}-->

                                            </div>

                                            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
                                                <div class="well">
                                                    <div class="form-group">
                                                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_issuedate, label:Issue-Date, readonly:true}-->
                                                    </div>

                                                    <div class="form-group">
                                                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_number, label:ID-Number, readonly:true}-->
                                                    </div>

                                                    <div class="form-group">
                                                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_expirydate, readonly:true}-->
                                                    </div>

                                                    <div class="form-group">
                                                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_issuestate, readonly:true, pattern:alpha}-->
                                                    </div>

                                                    <div class="form-group">
                                                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_issuecountry, readonly:true, pattern:alpha}-->
                                                    </div>

                                                    <!--#4DIF false-->
                                                    <div class="btn-group pull-right" role="group"
                                                        aria-label="profile-edit">
                                                        <a id="cancel-button-id" class="btn btn-default" role="button"
                                                            style='display:none;'
                                                            onclick="wapiObjectMethod(event)">Cancel</a>

                                                        <a id="edit-button-id" class="btn btn-primary" role="button"
                                                            style='display:block;'
                                                            onclick="wapiObjectMethod(event)">Edit</a>

                                                        <input id="save-button-id" class="btn btn-primary" type="submit"
                                                            value="Save" style='display:none;'>
                                                    </div>
                                                    <!--#4DENDIF-->
                                                </div>
                                            </div>
                                        

<!--loop thru and show other linkedDocs-->
<!--#4DEVAL Query([linkedDocs];[LinkedDocs]CustomerID=[Customers]CustomerID)-->
<!--#4DLOOP [LinkedDocs]-->
<div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
    <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___scannedimage, label:ID, readonly:true, image-width:310, image-height:0, image-compression:.5, image-upload:false}-->
</div>

<div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
    <div class="well">
        <div class="form-group">
            <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___issuedate, label:Issue-Date, readonly:true}-->
        </div>

        <div class="form-group">
            <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___docreference, label:ID-Number, readonly:true}-->
        </div>

        <div class="form-group">
            <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___expirydate, readonly:true}-->
        </div>

        <div class="form-group">
            <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___issuingauthority, readonly:true, pattern:alpha, width:100}-->
        </div>

        <div class="form-group">
            <!--#4DSCRIPT/WAPI_formGroup/{field:linkeddocs___issuecountry, readonly:true, pattern:alpha, width:100}-->
        </div>
    </div>
</div>
<!--#4DENDLOOP-->


                                        <!-- DROPZONE AREA FOR ADDITIONAL ATTACHMENTS -->                                       
                                        <div id="wapi-dropzone-group" class="hidden">
                                            <div class="dropzone-previews"></div>

                                            <div id="wapi-dropzone-select-group">
                                                <div class="form-group">
                                                    <label class="form-control-label" for="profile-id-type-select"
                                                        id="profile-id-type-label">Select the type of ID you will
                                                        upload</label>
                                                    <select class="form-control custom-select"
                                                        style="text-align-last:center;" id="profile-id-type-select"
                                                        name="profile-id-type-select"
                                                        onchange="$('#wapi-dropzone-drop-group').show();wapiObjectMethod(event)">
                                                        <option value="" label=""></option>
                                                    </select>
                                                    <span id="profile-id-type-select-help-block"
                                                        class="help-block"></span>
                                                </div>
                                            </div>

                                            <div id="wapi-dropzone-drop-group">
                                                <div class="dz-clickable" id="wapi-dropzone">
                                                    <div class="btn btn-default btn-block btn-lg"
                                                        style="padding-bottom: 12px">
                                                        <span id="profile-dropzone-btn">Click or Drop Files Here</span>
                                                        <script>
                                                            if (jQuery.browser.mobile) {
                                                                $('#profile-dropzone-btn').html(
                                                                    'Click to take picture');
                                                            }
                                                        </script>
                                                    </div>
                                                </div>

                                                <div class="form-group fallback">
                                                    <input id='dropzone-upload-file' type="file" multiple />
                                                </div>
                                            </div>
                                        
                                    </div>


                                    </div>
                                </form>
                            </div>
                        </div>

                    </div>
                </div>

            </div>

        </div>


    </main>

    <!--#4DSCRIPT/WAPI_4DInclude/customers/include/footer.shtml -->



    <!--dz-preview-template instead of the include-->
    <div class="hidden" id="tpl">
        <div class="row" style="padding-bottom: 40px; padding-top: 0px">

            <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
                <div class="dz-preview dz-file-preview" id="dz-preview-template">
                    <div class="dz-details">
                        <div class="small"><em><span data-dz-name></span></em></div>
                        <img class="img-thumbnail" data-dz-thumbnail />
                        <div class="small" style="padding-bottom: 20px; padding-top: 0px">[<span data-dz-size></span>]
                        </div>
                        <input class="btn btn-default" type="button" value="Remove ID" data-dz-remove>
                    </div>
                    <div class="dz-progress"><span class="dz-upload" data-dz-uploadprogress></span></div>
                    <div class="dz-success-mark"><span></span></div>
                    <div class="dz-error-mark"><span class=""></span></div>
                    <div class="dz-error-message"><span data-dz-errormessage></span></div>
                </div>
            </div>

            <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
                <div class="well">
                    <div class="form-group" id="customers-pictureid_templateid-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_templateid, label:ID-Type, readonly:true, onchange:wapiObjectMethod}-->
                    </div>

                    <div class="form-group" id="customers-pictureid_number-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_number, label:ID-Number, readonly:false}-->
                    </div>

                    <div class="form-group" id="customers-pictureid_issuedate-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_issuedate, label:Issue-Date, readonly:false, inputmask-selectyears:10}-->
                    </div>

                    <div class="form-group" id="customers-picture_expirydate-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___PictureID_ExpiryDate, label:Expiration-Date, readonly:false, inputmask-selectyears:10, inputmask-min:true}-->
                    </div>

                    <div class="form-group" id="customers-picture_authority-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_authority, label:Issued-By-Authority, readonly:false}-->
                    </div>

                    <div class="form-group" id="customers-picture_issuestate-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_issuestate, label:Issued-By-State, readonly:false}-->
                    </div>

                    <div class="form-group" id="customers-pictureid_countrycode-group">
                        <!--#4DSCRIPT/WAPI_formGroup/{field:customers___pictureid_countrycode, label:Issued-By-Country, choicelist:webGetChoiceListCountries, readonly:false}-->
                    </div>
                </div>
            </div>

        </div>
        <hr>
    </div>


    <script>
        function addDropZone(file) {
            debugger;
            let currId = wapi_dropzone.files.length;
            let issueOptions = {
                format: 'dd/mm/yyyy',
                editable: false,
                selectYears: 10,
                selectMonths: true,
                formatSubmit: 'yyyy-mm-ddT00:00:00',
                hiddenName: true,
                min: -3650,
                max: true,
                showMonthsShort: true
            }
            let expiryOptions = {
                format: 'dd/mm/yyyy',
                editable: false,
                selectYears: 10,
                selectMonths: true,
                formatSubmit: 'yyyy-mm-ddT00:00:00',
                hiddenName: true,
                min: -365,
                max: 3650,
                showMonthsShort: true
            }

            $('[id=customers-pictureid_issuedate-input]').pickadate(issueOptions);
            $('[id=customers-pictureid_expirydate-input]').pickadate(expiryOptions);


            let theID = wapi_dropzone.previewsContainer.getElementsByClassName("row")[currId - 1];
            let inputs = theID.getElementsByTagName("input");
            inputs['customers-pictureid_templateid-input'].value = $('#profile-id-type-select').val();

            if (currId > 0) {

                for (var i = 0; i < inputs.length; i++) {
                    inputs[i].id = inputs[i].id + '--' + currId;
                    inputs[i].name = inputs[i].name + '--' + currId;
                };

                let selects = theID.getElementsByTagName("select");
                for (var i = 0; i < selects.length; i++) {
                    selects[i].id = selects[i].id + '--' + currId;
                    selects[i].name = selects[i].name + '--' + currId;
                };

                let labels = theID.getElementsByClassName("form-control-label")
                for (var i = 0; i < labels.length; i++){
labels[i].id = labels[i].id + '--' + currId;
                };

            };

            //wapi_dropzone.disable();
            $('#profile-id-type-select').val('');
            wapiObjectMethod(event);

        }
    </script>

    <script>
        function removeDropZone(file) {
            $("#wapi-dropzone-add-group").show();
        }
    </script>

    <!--#4DSCRIPT/WAPI_formInit-->
</body>


</html>